/*! Hammer.JS - v1.0.6 - 2014-01-02
 * http://eightmedia.github.com/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */

!function(t,e){function i(){n.READY||(n.event.determineEventTypes(),n.utils.each(n.gestures,function(t){n.detection.register(t)}),n.event.onTouch(n.DOCUMENT,n.EVENT_MOVE,n.detection.detect),n.event.onTouch(n.DOCUMENT,n.EVENT_END,n.detection.detect),n.READY=!0)}var n=function(t,e){return new n.Instance(t,e||{})};n.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},n.HAS_POINTEREVENTS=t.navigator.pointerEnabled||t.navigator.msPointerEnabled,n.HAS_TOUCHEVENTS="ontouchstart"in t,n.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,n.NO_MOUSEEVENTS=n.HAS_TOUCHEVENTS&&t.navigator.userAgent.match(n.MOBILE_REGEX),n.EVENT_TYPES={},n.DIRECTION_DOWN="down",n.DIRECTION_LEFT="left",n.DIRECTION_UP="up",n.DIRECTION_RIGHT="right",n.POINTER_MOUSE="mouse",n.POINTER_TOUCH="touch",n.POINTER_PEN="pen",n.EVENT_START="start",n.EVENT_MOVE="move",n.EVENT_END="end",n.DOCUMENT=t.document,n.plugins=n.plugins||{},n.gestures=n.gestures||{},n.READY=!1,n.utils={extend:function(t,i,n){for(var o in i)t[o]!==e&&n||(t[o]=i[o]);return t},each:function(t,i,n){var o,s;if("forEach"in t)t.forEach(i,n);else if(t.length!==e){for(o=0,s=t.length;s>o;o++)if(i.call(n,t[o],o,t)===!1)return}else for(o in t)if(t.hasOwnProperty(o)&&i.call(n,t[o],o,t)===!1)return},hasParent:function(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1},getCenter:function(t){var e=[],i=[];return n.utils.each(t,function(t){e.push("undefined"!=typeof t.clientX?t.clientX:t.pageX),i.push("undefined"!=typeof t.clientY?t.clientY:t.pageY)}),{pageX:(Math.min.apply(Math,e)+Math.max.apply(Math,e))/2,pageY:(Math.min.apply(Math,i)+Math.max.apply(Math,i))/2}},getVelocity:function(t,e,i){return{x:Math.abs(e/t)||0,y:Math.abs(i/t)||0}},getAngle:function(t,e){var i=e.pageY-t.pageY,n=e.pageX-t.pageX;return 180*Math.atan2(i,n)/Math.PI},getDirection:function(t,e){var i=Math.abs(t.pageX-e.pageX),o=Math.abs(t.pageY-e.pageY);return i>=o?t.pageX-e.pageX>0?n.DIRECTION_LEFT:n.DIRECTION_RIGHT:t.pageY-e.pageY>0?n.DIRECTION_UP:n.DIRECTION_DOWN},getDistance:function(t,e){var i=e.pageX-t.pageX,n=e.pageY-t.pageY;return Math.sqrt(i*i+n*n)},getScale:function(t,e){return t.length>=2&&e.length>=2?this.getDistance(e[0],e[1])/this.getDistance(t[0],t[1]):1},getRotation:function(t,e){return t.length>=2&&e.length>=2?this.getAngle(e[1],e[0])-this.getAngle(t[1],t[0]):0},isVertical:function(t){return t==n.DIRECTION_UP||t==n.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(t,e){e&&t&&t.style&&(n.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(i){n.utils.each(e,function(e){i&&(e=i+e.substring(0,1).toUpperCase()+e.substring(1)),e in t.style&&(t.style[e]=e)})}),"none"==e.userSelect&&(t.onselectstart=function(){return!1}),"none"==e.userDrag&&(t.ondragstart=function(){return!1}))}},n.Instance=function(t,e){var o=this;return i(),this.element=t,this.enabled=!0,this.options=n.utils.extend(n.utils.extend({},n.defaults),e||{}),this.options.stop_browser_behavior&&n.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),n.event.onTouch(t,n.EVENT_START,function(t){o.enabled&&n.detection.startDetect(o,t)}),this},n.Instance.prototype={on:function(t,e){var i=t.split(" ");return n.utils.each(i,function(t){this.element.addEventListener(t,e,!1)},this),this},off:function(t,e){var i=t.split(" ");return n.utils.each(i,function(t){this.element.removeEventListener(t,e,!1)},this),this},trigger:function(t,e){e||(e={});var i=n.DOCUMENT.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e;var o=this.element;return n.utils.hasParent(e.target,o)&&(o=e.target),o.dispatchEvent(i),this},enable:function(t){return this.enabled=t,this}};var o=null,s=!1,a=!1;n.event={bindDom:function(t,e,i){var o=e.split(" ");n.utils.each(o,function(e){t.addEventListener(e,i,!1)})},onTouch:function(t,e,i){var r=this;this.bindDom(t,n.EVENT_TYPES[e],function(h){var c=h.type.toLowerCase();if(!c.match(/mouse/)||!a){c.match(/touch/)||c.match(/pointerdown/)||c.match(/mouse/)&&1===h.which?s=!0:c.match(/mouse/)&&!h.which&&(s=!1),c.match(/touch|pointer/)&&(a=!0);var l=0;s&&(n.HAS_POINTEREVENTS&&e!=n.EVENT_END?l=n.PointerEvent.updatePointer(e,h):c.match(/touch/)?l=h.touches.length:a||(l=c.match(/up/)?0:1),l>0&&e==n.EVENT_END?e=n.EVENT_MOVE:l||(e=n.EVENT_END),(l||null===o)&&(o=h),i.call(n.detection,r.collectEventData(t,e,r.getTouchList(o,e),h)),n.HAS_POINTEREVENTS&&e==n.EVENT_END&&(l=n.PointerEvent.updatePointer(e,h))),l||(o=null,s=!1,a=!1,n.PointerEvent.reset())}})},determineEventTypes:function(){var t;t=n.HAS_POINTEREVENTS?n.PointerEvent.getEvents():n.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],n.EVENT_TYPES[n.EVENT_START]=t[0],n.EVENT_TYPES[n.EVENT_MOVE]=t[1],n.EVENT_TYPES[n.EVENT_END]=t[2]},getTouchList:function(t){return n.HAS_POINTEREVENTS?n.PointerEvent.getTouchList():t.touches?t.touches:(t.identifier=1,[t])},collectEventData:function(t,e,i,o){var s=n.POINTER_TOUCH;return(o.type.match(/mouse/)||n.PointerEvent.matchType(n.POINTER_MOUSE,o))&&(s=n.POINTER_MOUSE),{center:n.utils.getCenter(i),timeStamp:(new Date).getTime(),target:o.target,touches:i,eventType:e,pointerType:s,srcEvent:o,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return n.detection.stopDetect()}}}},n.PointerEvent={pointers:{},getTouchList:function(){var t=this,e=[];return n.utils.each(t.pointers,function(t){e.push(t)}),e},updatePointer:function(t,e){return t==n.EVENT_END?this.pointers={}:(e.identifier=e.pointerId,this.pointers[e.pointerId]=e),Object.keys(this.pointers).length},matchType:function(t,e){if(!e.pointerType)return!1;var i=e.pointerType,o={};return o[n.POINTER_MOUSE]=i===e.MSPOINTER_TYPE_MOUSE||i===n.POINTER_MOUSE,o[n.POINTER_TOUCH]=i===e.MSPOINTER_TYPE_TOUCH||i===n.POINTER_TOUCH,o[n.POINTER_PEN]=i===e.MSPOINTER_TYPE_PEN||i===n.POINTER_PEN,o[t]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},n.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(t,e){this.current||(this.stopped=!1,this.current={inst:t,startEvent:n.utils.extend({},e),lastEvent:!1,name:""},this.detect(e))},detect:function(t){if(this.current&&!this.stopped){t=this.extendEventData(t);var e=this.current.inst.options;return n.utils.each(this.gestures,function(i){return this.stopped||e[i.name]===!1||i.handler.call(i,t,this.current.inst)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=t),t.eventType==n.EVENT_END&&!t.touches.length-1&&this.stopDetect(),t}},stopDetect:function(){this.previous=n.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(t){var e=this.current.startEvent;!e||t.touches.length==e.touches.length&&t.touches!==e.touches||(e.touches=[],n.utils.each(t.touches,function(t){e.touches.push(n.utils.extend({},t))}));var i,o,s=t.timeStamp-e.timeStamp,a=t.center.pageX-e.center.pageX,r=t.center.pageY-e.center.pageY,h=n.utils.getVelocity(s,a,r);return"end"===t.eventType?(i=this.current.lastEvent&&this.current.lastEvent.interimAngle,o=this.current.lastEvent&&this.current.lastEvent.interimDirection):(i=this.current.lastEvent&&n.utils.getAngle(this.current.lastEvent.center,t.center),o=this.current.lastEvent&&n.utils.getDirection(this.current.lastEvent.center,t.center)),n.utils.extend(t,{deltaTime:s,deltaX:a,deltaY:r,velocityX:h.x,velocityY:h.y,distance:n.utils.getDistance(e.center,t.center),angle:n.utils.getAngle(e.center,t.center),interimAngle:i,direction:n.utils.getDirection(e.center,t.center),interimDirection:o,scale:n.utils.getScale(e.touches,t.touches),rotation:n.utils.getRotation(e.touches,t.touches),startEvent:e}),t},register:function(t){var i=t.defaults||{};return i[t.name]===e&&(i[t.name]=!0),n.utils.extend(n.defaults,i,!0),t.index=t.index||1e3,this.gestures.push(t),this.gestures.sort(function(t,e){return t.index<e.index?-1:t.index>e.index?1:0}),this.gestures}},n.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(t,e){if(n.detection.current.name!=this.name&&this.triggered)return e.trigger(this.name+"end",t),void(this.triggered=!1);if(!(e.options.drag_max_touches>0&&t.touches.length>e.options.drag_max_touches))switch(t.eventType){case n.EVENT_START:this.triggered=!1;break;case n.EVENT_MOVE:if(t.distance<e.options.drag_min_distance&&n.detection.current.name!=this.name)return;if(n.detection.current.name!=this.name&&(n.detection.current.name=this.name,e.options.correct_for_drag_min_distance&&t.distance>0)){var i=Math.abs(e.options.drag_min_distance/t.distance);n.detection.current.startEvent.center.pageX+=t.deltaX*i,n.detection.current.startEvent.center.pageY+=t.deltaY*i,t=n.detection.extendEventData(t)}(n.detection.current.lastEvent.drag_locked_to_axis||e.options.drag_lock_to_axis&&e.options.drag_lock_min_distance<=t.distance)&&(t.drag_locked_to_axis=!0);var o=n.detection.current.lastEvent.direction;t.drag_locked_to_axis&&o!==t.direction&&(t.direction=n.utils.isVertical(o)?t.deltaY<0?n.DIRECTION_UP:n.DIRECTION_DOWN:t.deltaX<0?n.DIRECTION_LEFT:n.DIRECTION_RIGHT),this.triggered||(e.trigger(this.name+"start",t),this.triggered=!0),e.trigger(this.name,t),e.trigger(this.name+t.direction,t),(e.options.drag_block_vertical&&n.utils.isVertical(t.direction)||e.options.drag_block_horizontal&&!n.utils.isVertical(t.direction))&&t.preventDefault();break;case n.EVENT_END:this.triggered&&e.trigger(this.name+"end",t),this.triggered=!1}}},n.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(t,e){switch(t.eventType){case n.EVENT_START:clearTimeout(this.timer),n.detection.current.name=this.name,this.timer=setTimeout(function(){"hold"==n.detection.current.name&&e.trigger("hold",t)},e.options.hold_timeout);break;case n.EVENT_MOVE:t.distance>e.options.hold_threshold&&clearTimeout(this.timer);break;case n.EVENT_END:clearTimeout(this.timer)}}},n.gestures.Release={name:"release",index:1/0,handler:function(t,e){t.eventType==n.EVENT_END&&e.trigger(this.name,t)}},n.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(t,e){if(t.eventType==n.EVENT_END){if(e.options.swipe_max_touches>0&&t.touches.length<e.options.swipe_min_touches&&t.touches.length>e.options.swipe_max_touches)return;(t.velocityX>e.options.swipe_velocity||t.velocityY>e.options.swipe_velocity)&&(e.trigger(this.name,t),e.trigger(this.name+t.direction,t))}}},n.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(t,e){if(t.eventType==n.EVENT_END&&"touchcancel"!=t.srcEvent.type){var i=n.detection.previous,o=!1;if(t.deltaTime>e.options.tap_max_touchtime||t.distance>e.options.tap_max_distance)return;i&&"tap"==i.name&&t.timeStamp-i.lastEvent.timeStamp<e.options.doubletap_interval&&t.distance<e.options.doubletap_distance&&(e.trigger("doubletap",t),o=!0),(!o||e.options.tap_always)&&(n.detection.current.name="tap",e.trigger(n.detection.current.name,t))}}},n.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(t,e){return e.options.prevent_mouseevents&&t.pointerType==n.POINTER_MOUSE?void t.stopDetect():(e.options.prevent_default&&t.preventDefault(),void(t.eventType==n.EVENT_START&&e.trigger(this.name,t)))}},n.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(t,e){if(n.detection.current.name!=this.name&&this.triggered)return e.trigger(this.name+"end",t),void(this.triggered=!1);if(!(t.touches.length<2))switch(e.options.transform_always_block&&t.preventDefault(),t.eventType){case n.EVENT_START:this.triggered=!1;break;case n.EVENT_MOVE:var i=Math.abs(1-t.scale),o=Math.abs(t.rotation);if(i<e.options.transform_min_scale&&o<e.options.transform_min_rotation)return;n.detection.current.name=this.name,this.triggered||(e.trigger(this.name+"start",t),this.triggered=!0),e.trigger(this.name,t),o>e.options.transform_min_rotation&&e.trigger("rotate",t),i>e.options.transform_min_scale&&(e.trigger("pinch",t),e.trigger("pinch"+(t.scale<1?"in":"out"),t));break;case n.EVENT_END:this.triggered&&e.trigger(this.name+"end",t),this.triggered=!1}}},n.plugins.fakeMultitouch=function(){var t=!1;n.HAS_POINTEREVENTS=navigator.msPointerEnabled&&navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>=1,n.event.getTouchList=function(e,i){if(n.HAS_POINTEREVENTS)return n.PointerEvent.getTouchList();if(e.touches)return e.touches;if(i==n.EVENT_START&&(t=!1),e.shiftKey){t||(t={pageX:e.pageX,pageY:e.pageY});var o=t.pageX-e.pageX,s=t.pageY-e.pageY;return[{identifier:1,pageX:t.pageX-o-50,pageY:t.pageY-s+50,target:e.target},{identifier:2,pageX:t.pageX+o+50,pageY:t.pageY+s-50,target:e.target}]}return t=!1,[{identifier:1,pageX:e.pageX,pageY:e.pageY,target:e.target}]}},n.plugins.showTouches=function(t){function e(){for(var t in o)o.hasOwnProperty(t)&&!s[t]&&(document.body.removeChild(o[t]),delete o[t])}var i="position:absolute;z-index:9999;left:0;top:0;height:14px;width:14px;border:solid 2px #777;background:rgba(255,255,255,.7);border-radius:20px;pointer-events:none;margin-top:-9px;margin-left:-9px;",o={},s={};n.detection.register({name:"show_touches",priority:0,handler:function(a){if(s={},a.pointerType!=n.POINTER_MOUSE&&!t)return void e();for(var r=0,h=a.touches.length;h>r;r++){var c=a.touches[r],l=c.identifier;if(s[l]=c,!o[l]){var u=document.createElement("div");u.setAttribute("style",i),document.body.appendChild(u),o[l]=u}o[l].style.left=c.pageX+"px",o[l].style.top=c.pageY+"px"}e()}})},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("hammer",[],function(){return n}):"object"==typeof module&&"object"==typeof module.exports?module.exports=n:t.Hammer=n}(this),define("scalejs.canvas/utils",[],function(){var t={left:function(){return 0},top:function(){return 0},center:function(t){return-t/2},right:function(t){return-t},bottom:function(t){return-t}},e={left:function(t){return t},top:function(t){return t},center:function(t,e){return t-e/2},right:function(t,e){return t-e},bottom:function(t,e){return t-e}};return{getOffset:t,applyOffset:e}}),define("scalejs.canvas/group",["./utils"],function(t){return function(e){function i(t){this.type="group",this.className="group",this.parent=t.parent||e,this.id=t.id||t.parent.children.length,this.data=t.data||{},this.fontFamily=t.fontFamily||"",this.fontSize=t.fontSize||0,this.originX=t.originX||"left",this.originY=t.originY||"top",this.left=t.left||0,this.top=t.top||0,this.width=t.width||0,this.height=t.height||0,this.angle=t.angle||0,this.scaleX=t.scaleX||1,this.scaleY=t.scaleY||1,this.backFill=t.backFill||"",this.opacity=t.opacity||1,this.offset={left:0,top:0},this.pos={left:0,top:0},this.extents={left:0,top:0,right:0,bottom:0},this.children=[]}return i.prototype.getExtents=function(){return this.extents},i.prototype.calcBounds=function(){var i,n;this.fontFamily&&this.fontSize?(this.font=this.fontSize+"px "+this.fontFamily,this.font!==e.curFont&&(i=e.curFont,n=e.curFontSize,e.context.save(),e.context.font=this.font,e.curFont=this.font,e.curFontSize=this.fontSize)):this.font=void 0;for(var o=0;o<this.children.length;o++)this.children[o].calcBounds();i&&(e.curFont=i,e.curFontSize=n,e.context.restore()),this.offset.left=t.getOffset[this.originX](this.width),this.offset.top=t.getOffset[this.originY](this.height),this.pos.left=this.left+this.offset.left,this.pos.top=this.top+this.offset.top,this.radianAngle=this.angle*Math.PI/180},i.prototype.render=function(){if(!(this.opacity<=0)){if(e.context.save(),this.opacity<1&&(e.context.globalAlpha*=this.opacity),e.context.translate(this.pos.left,this.pos.top),e.context.scale(this.scaleX,this.scaleY),e.context.rotate(this.radianAngle),this.backFill&&this.width>0&&this.height>0&&(e.context.fillStyle=this.backFill,e.context.fillRect(0,0,this.width,this.height)),this.font&&this.font!==e.curFont){var t=e.curFont,i=e.curFontSize;e.context.font=this.font,e.curFont=this.font,e.curFontSize=this.fontSize;for(var n=0;n<this.children.length;n++)this.children[n].render();e.curFont=t,e.curFontSize=i}else for(var n=0;n<this.children.length;n++)this.children[n].render();e.context.restore()}},i.prototype.isPointIn=function(t,e,i){t-=this.pos.left,e-=this.pos.top,t/=this.scaleX,e/=this.scaleY;var n=Math.sin(-this.radianAngle),o=Math.cos(-this.radianAngle),s=t;if(t=t*o-e*n,e=s*n+e*o,this.backFill)return t>=0&&e>=0&&t<=this.width&&e<=this.height;for(var a=0;a<this.children.length;a++)if(this.children[a].isPointIn(t,e,i))return!0;return!1},i.prototype.touchEventHandler=function(t,e,i){t-=this.pos.left,e-=this.pos.top,t/=this.scaleX,e/=this.scaleY;var n=Math.sin(-this.radianAngle),o=Math.cos(-this.radianAngle),s=t;t=t*o-e*n,e=s*n+e*o;for(var a=0;a<this.children.length;a++)this.children[a].isPointIn(t,e,i)&&this.children[a].touchEventHandler(t,e,i);this[i.name]&&this[i.name](this.data.data)},i.prototype.remove=function(){this.parent.children.splice(this.parent.children.indexOf(this),1)},i}}),define("scalejs.canvas/rect",["./utils"],function(t){return function(e){function i(t){this.type="obj",this.className="rect",this.parent=t.parent||e,this.id=t.id||t.parent.children.length,this.data=t.data||{},this.originX=t.originX||"left",this.originY=t.originY||"top",this.left=t.left||0,this.top=t.top||0,this.width=t.width||0,this.height=t.height||0,this.fill=t.fill||"#000",this.offset={left:0,top:0},this.pos={left:0,top:0},this.extents={left:0,top:0,right:0,bottom:0}}return i.prototype.getExtents=function(){return this.extents},i.prototype.calcBounds=function(){this.offset.left=t.getOffset[this.originX](this.width),this.offset.top=t.getOffset[this.originY](this.height),this.pos.left=this.left+this.offset.left,this.pos.top=this.top+this.offset.top,this.extents.left=this.pos.left,this.extents.top=this.pos.top,this.extents.right=this.pos.left+this.width,this.extents.bottom=this.pos.top+this.height},i.prototype.render=function(){this.width>0&&this.height>0&&(e.context.fillStyle=this.fill,e.context.fillRect(this.pos.left,this.pos.top,this.width,this.height))},i.prototype.isPointIn=function(t,e){return t>=this.extents.left&&e>=this.extents.top&&t<=this.extents.right&&e<=this.extents.bottom},i.prototype.touchEventHandler=function(t,e,i){this[i.name]&&this[i.name](this.data.data)},i.prototype.remove=function(){this.parent.children.splice(this.parent.children.indexOf(this),1)},i}}),define("scalejs.canvas/text",["./utils"],function(t){return function(e){function i(t){this.type="obj",this.className="text",this.parent=t.parent||e,this.id=t.id||t.parent.children.length,this.data=t.data||{},this.fontFamily=t.fontFamily||"",this.fontSize=t.fontSize||0,this.text=t.text||"",this.originX=t.originX||"left",this.originY=t.originY||"top",this.left=t.left||0,this.top=t.top||0,this.width=t.width||0,this.height=t.height||0,this.angle=t.angle||0,this.fill=t.fill||"#000",this.offset={left:0,top:0},this.pos={left:0,top:0},this.extents={left:0,top:0,right:0,bottom:0}}return i.prototype.opacity=1,i.prototype.setText=function(t){this.fontFamily&&this.fontSize?(this.font=this.fontSize+"px "+this.fontFamily,this.height=this.fontSize):(this.font=void 0,this.height=e.curFontSize),!this.font||this.font===this.calcFont&&this.calcText===this.text?this.font||e.curFont===this.calcFont&&this.calcText===this.text||(this.text=t,this.width=e.context.measureText(t||"").width,this.calcText=this.text,this.calcFont=e.curFont):(e.context.save(),e.context.font=this.font,this.text=t,this.width=e.context.measureText(t||"").width,e.context.restore(),this.calcText=this.text,this.calcFont=this.font)},i.prototype.getExtents=function(){return this.extents},i.prototype.calcBounds=function(){this.setText(this.text),this.offset.left=t.getOffset[this.originX](this.width),this.offset.top=t.getOffset[this.originY](this.height)+this.height,this.pos.left=this.left+this.offset.left,this.pos.top=this.top+this.offset.top,this.extents.left=this.pos.left,this.extents.right=this.pos.left,this.extents.top=this.pos.top+this.width,this.extents.bottom=this.pos.top+this.height},i.prototype.render=function(){this.opacity>0&&this.text.length>0&&(e.context.save(),this.font&&this.font!==e.curFont&&(e.context.font=this.font),this.fill&&(e.context.fillStyle=this.fill),this.opacity<1&&(e.context.globalAlpha*=this.opacity),e.context.translate(this.left,this.top),this.angle&&e.context.rotate(this.angle*Math.PI/180),e.context.fillText(this.text,this.offset.left,this.offset.top),e.context.restore())},i.prototype.isPointIn=function(t,e){return t>=this.extents.left&&e>=this.extents.top&&t<=this.extents.right&&e<=this.extents.bottom},i.prototype.touchEventHandler=function(t,e,i){this[i.name]&&this[i.name](this.data.data)},i.prototype.remove=function(){this.parent.children.splice(this.parent.children.indexOf(this),1)},i}}),define("scalejs.canvas/arc",["./utils"],function(){var t=.5*Math.PI;return function(e){function i(t){this.type="obj",this.className="arc",this.parent=t.parent||e,this.id=t.id||t.parent.children.length,this.data=t.data||{},this.originX=t.originX||"center",this.originY=t.originY||"center",this.left=t.left||0,this.top=t.top||0,this.width=t.width||0,this.height=t.height||0,this.radius=0,this.innerRadius=t.innerRadius||0,this.outerRadius=t.outerRadius||0,this.thickness=0,this.startAngle=t.startAngle||0,this.endAngle=t.endAngle||0,this.fill=t.fill||"#000",this.opacity=t.opacity||1,this.offset={left:0,top:0},this.pos={left:0,top:0},this.extents={left:0,top:0,right:0,bottom:0}}return i.prototype.getExtents=function(){return this.extents},i.prototype.calcBounds=function(){this.width=this.height=2*this.outerRadius,this.offset.left=this.left,this.offset.top=this.top,this.extents.left=this.offset.left-this.outerRadius,this.extents.right=this.offset.left+this.outerRadius,this.extents.top=this.offset.top-this.outerRadius,this.extents.bottom=this.offset.top+this.outerRadius,this.thickness=this.outerRadius-this.innerRadius,this.radius=this.thickness/2+this.innerRadius},i.prototype.render=function(){this.opacity>0&&0!==this.thickness&&this.endAngle!==this.startAngle&&(e.context.beginPath(),this.fill&&(e.context.strokeStyle=this.fill),this.opacity<1&&(e.context.globalAlpha*=this.opacity),e.context.lineWidth=this.thickness,e.context.arc(this.offset.left,this.offset.top,this.radius,this.startAngle-t,this.endAngle-t),e.context.stroke())},i.prototype.isPointIn=function(e,i){var n=(e-this.offset.left)*(e-this.offset.left)+(i-this.offset.top)*(i-this.offset.top),o=Math.atan2(i-this.offset.top,e-this.offset.left)+t;return 0>o&&(o+=2*Math.PI),n<=this.outerRadius*this.outerRadius&&n>=this.innerRadius*this.innerRadius&&o>=this.startAngle&&o<=this.endAngle},i.prototype.touchEventHandler=function(t,e,i){this[i.name]&&this[i.name](this.data.data)},i.prototype.remove=function(){this.parent.children.splice(this.parent.children.indexOf(this),1)},i}}),define("scalejs.canvas/selector",["./group","./rect","./text","./arc"],function(t,e,i,n){var o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60),!0};return function(s){function a(t){this.isTransition=t.isTransition||!1,this.durationTime=t.durationTime||250,this.easeFunc=t.easeFunc||function(t){return t},this.endFunc=void 0,this.object=t.object||s,this.objects=t.objects||[],this.enterObjects=t.enterObjects||[],this.updateObjects=t.updateObjects||[],this.exitObjects=t.exitObjects||[]}var r,h={group:t(s),rect:e(s),text:i(s),arc:n(s)};return a.prototype.select=function(t){var e,i,n,o=[];for(i=0;i<this.objects.length;i++)if(e=this.objects[i],void 0!==e.children&&e.children.length>0)for(n=0;n<e.children.length;n++)if(e.children[n].className===t){o.push(e.children[n]);break}return new a({isTransition:this.isTransition,durationTime:this.durationTime,easeFunc:this.easeFunc,object:o.length>0?o[0].parent:this.objects.length>0?this.objects[0]:this.object,objects:o})},a.prototype.selectAll=function(t){var e,i,n,o=[];for(i=0;i<this.objects.length;i++)if(e=this.objects[i],void 0!==e.children&&e.children.length>0)for(n=0;n<e.children.length;n++)e.children[n].className===t&&o.push(e.children[n]);return new a({isTransition:this.isTransition,durationTime:this.durationTime,easeFunc:this.easeFunc,object:o.length>0?o[0].parent:this.objects.length>0?this.objects[0]:this.object,objects:o})},a.prototype.filter=function(t){for(var e=[],i=0;i<this.objects.length;i++)t.call(this.objects[i],this.objects[i].data.data)&&e.push(this.objects[i]);return new a({isTransition:this.isTransition,durationTime:this.durationTime,easeFunc:this.easeFunc,object:e.length>0?e[0].parent:this.objects.length>0?this.objects[0]:this.object,objects:e})},a.prototype.data=function(t,e){for(var i={},n=0;n<t.length;n++){var o=e(t[n]);t[n]={id:o,data:t[n]},i[o]=t[n]}this.exitObjects=[],this.updateObjects=this.objects,this.objects=[];for(var n=0;n<this.updateObjects.length;n++)i[this.updateObjects[n].data.id]?(this.updateObjects[n].data.data=i[this.updateObjects[n].data.id].data,i[this.updateObjects[n].data.id]=void 0,this.objects.push(this.updateObjects[n])):(this.exitObjects.push(this.updateObjects[n]),this.updateObjects.splice(n,1),n--);for(var n=0;n<t.length;n++)i[t[n].id]||(t.splice(n,1),n--);return this.enterObjects=t,this},a.prototype.enter=function(){return{parentSelector:this,append:function(t,e){return e=e||{},new a({isTransition:this.parentSelector.isTransition,durationTime:this.parentSelector.durationTime,easeFunc:this.parentSelector.easeFunc,objects:this.parentSelector.enterObjects.map(function(i){e.parent=this.parentSelector.object,e.data=i;var n=new h[t](e);return this.parentSelector.object.children.push(n),n},this)})}}},a.prototype.update=function(){var t=new a(this);return t.objects=this.updateObjects,t},a.prototype.exit=function(){var t=new a(this);return t.objects=this.exitObjects,t},a.prototype.on=function(t,e){return t="on"+t,this.objects.forEach(function(i){i[t]=e}),this},a.prototype.append=function(t,e){e=e||{};var i=new a(this);return i.objects=this.objects.map(function(i){e.parent=i,e.data=i.data;var n=new h[t](e);return i.children.push(n),n}),i},a.prototype.remove=function(){return this.objects.forEach(function(t){t.parent.children.splice(t.parent.children.indexOf(t),1)}),this.objects=[],this},a.prototype.attr=function(t,e){return this.objects.forEach(function(i){e instanceof Function&&(e=e.call(i,i.data.data)),i["set"+t]instanceof Function?i["set"+t](e):i[t]=e}),this},a.prototype.sort=function(t){return this.objects.sort(function(e,i){return t(e.data.data,i.data.data)}),this},a.prototype.order=function(){return this.objects.forEach(function(t){t.parent.children.splice(t.parent.children.indexOf(t),1),t.parent.children.push(t)}),this},a.prototype.each=function(t,e){return void 0===e||"start"===e?this.objects.forEach(function(e){t.call(e,e.data.data)}):"end"===e&&this.objects.forEach(function(e){e.tweenEndFunc=t}),this},a.prototype.transition=function(){var t=new a(this);return t.isTransition=!0,t.objects.forEach(function(t){t.tweenEndFunc=void 0}),t},a.prototype.duration=function(t){return this.durationTime=t,this},a.prototype.ease=function(t){return this.easeFunc=t,this},a.prototype.tween=function(t,e){var i,n,a=(new Date).getTime(),r=a+this.durationTime;for(n=0;n<this.objects.length;n++)i=this.objects[n],i.animationIndex>=0||(i.animationIndex=s.animations.length,s.animations[i.animationIndex]=i),i.tweenFunc=e.call(i,i.data.data),i.easeFunc=this.easeFunc,i.timeStart=a,i.timeEnd=r,i.duration=this.durationTime;return void 0===s.requestFrameID&&s.animations.length>0&&(s.requestFrameID=o(function(){s.onAnimationFrame()})),this},a.prototype.startRender=function(){},a.prototype.pumpRender=function(){return s.pumpRender(),r},r=new a({objects:[s]}),r[0]=[s.element],r}}),define("scalejs.canvas/canvas",["hammer","./selector"],function(t,e){function i(t){this.type="canvas",this.className="canvas",this.element=t,this.context=t.getContext("2d"),this.parent=this,this.width=t.width,this.height=t.height,this.children=[],this.animations=[],this.requestFrameID=void 0,this.curFont="",this.curFontSize=0}function n(n){function o(t){if(t.gesture&&(t.gesture.preventDefault(),1===t.gesture.touches.length)){var e,i=t.gesture.touches[0],n=i.target.style.display;i.target.style.display="",e=i.target.getBoundingClientRect(),i.target.style.display=n,t.offsetX=i.pageX-e.left,t.offsetY=i.pageY-e.top,t.name="on"+t.type;for(var o=0;o<s.children.length;o++)s.children[o].isPointIn(t.offsetX,t.offsetY,t)&&s.children[o].touchEventHandler(t.offsetX,t.offsetY,t)}}var s=new i(n),a=t(s.element,{prevent_default:!0,drag_min_distance:10,hold_threshold:10});return a.on("hold tap doubletap touch release",o),e(s)}var o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60),!0};return i.prototype.setwidth=function(t){this.element.width=t,this.width=t},i.prototype.setheight=function(t){this.element.height=t,this.height=t},i.prototype.onAnimationFrame=function(){if(this.animations.length<=0||this.width<=0||this.height<=0)return void(this.requestFrameID=void 0);var t=this;this.requestFrameID=o(function(){t.onAnimationFrame()});for(var e,i=(new Date).getTime(),n=0;n<this.animations.length;n++){e=this.animations[n];var s=Math.min((i-e.timeStart)/e.duration,1);e.tweenFunc(e.easeFunc(s)),i>=e.timeEnd?(e.animationIndex=void 0,e.tweenEndFunc&&e.tweenEndFunc(e.data.data),this.animations.splice(n,1),n--):e.animationIndex=n}this.render()},i.prototype.render=i.prototype.pumpRender=function(){if(!(this.width<=0||this.height<=0)){this.context.setTransform(1,0,0,1,0,0),this.context.font="40px Times New Roman",this.curFont="40px Times New Roman",this.curFontSize=40;for(var t=0;t<this.children.length;t++)this.children[t].calcBounds();this.context.clearRect(0,0,this.element.width,this.element.height);for(var t=0;t<this.children.length;t++)this.children[t].render()}},i.prototype.startRender=function(){console.warn("canvas.startRender is deprecated!")},{select:n}}),define("scalejs.canvas",["scalejs!core","./scalejs.canvas/canvas"],function(t,e){return t.registerExtension({canvas:e}),e}),define("scalejs.visualization-d3/canvas-helper",["d3","scalejs.canvas"],function(t,e){function i(i){for(var n,o,s,a,r;i.firstChild;)i.removeChild(i.firstChild);return n=window.getComputedStyle(i),o=parseInt(n.width,10),o=o>=1?o:1,s=parseInt(n.height,10),s=s>=1?s:1,a=t.select(i).style("overflow","hidden").append("canvas").attr("width",o).attr("height",s).attr("display","none").node(),r=e.select(a).ease(t.ease("cubic-in-out")),{elementStyle:n,canvasWidth:o,canvasHeight:s,canvasElement:a,canvas:r}}return{initializeCanvas:i}}),define("scalejs.visualization-d3/nested-data-helper",[],function(){function t(t,e){var i,n=e;if(t instanceof Array){for(i=0;i<t.length;i+=1){if(void 0===n.childrenReference[t[i]])return;n=n.childrenReference[t[i]]}return n}}function e(t,e){for(var i=0;e.indexOf(t)<0;)i+=1,t=t.parent;return i}function i(t){for(var e=[];void 0!==t.parent;)e.push(t),t=t.parent;return e.push(t),e}function n(t){for(var e=[],i=t;void 0!==i.parent;)e.unshift(i.index),i=i.parent;return e}return{getNode:t,getDistanceToTreePath:e,getNodeTreePath:i,createNodePath:n}}),define("scalejs.visualization-d3/gesture-helper",["scalejs!core","d3","knockout","scalejs.visualization-d3/nested-data-helper"],function(t,e,i,n){var o=i.utils.unwrapObservable,s=i.isObservable,a=n.getNode,r=n.createNodePath;
return function(){function n(n,u,d,p,f,g,v,m,x,y,E,T,b){function _(){var t,e,i=n.canvasWidth,o=n.canvasHeight,s=window.getComputedStyle(T);t=parseInt(s.width,10),t=t>=1?t:1,e=parseInt(s.height,10),e=e>=1?e:1,(t!==i||e!==o)&&(y(t,e),S(n.canvas),b())}function P(){f(void 0)}function w(t){g(r(t))}function N(t){f(r(t))}function S(t){c.left=0,c.top=0,c.rotate=0,c.scale=1,t.select("group").transition().duration(1e3).tween("canvasTween",function(){var t=e.interpolate(this.left,0),i=e.interpolate(this.top,0),n=e.interpolate(this.angle,0),o=e.interpolate(this.scaleX,1),s=e.interpolate(this.scaleY,1),a=this;return function(e){a.left=t(e),a.top=i(e),a.angle=n(e),a.scaleX=o(e),a.scaleY=s(e)}})}function z(t){var i,s=[],r=a(v(),m());if(o(p)){for(x&&t===r&&(t=m()),t!==r&&S(n.canvas),i=t,m().curLevel=i.lvl,m().curMaxLevel=i.lvl+m().maxVisibleLevels-1;void 0!==i.parent;)s.unshift(i.index),i=i.parent;v(s)}e.event&&e.event.stopPropagation()}function O(t,e,i,o){c.left=t,c.top=e,c.rotate=i,c.scale=o,n.canvas.select("group").attr("scaleX",c.scale).attr("scaleY",c.scale).attr("angle",c.rotate).attr("left",c.left).attr("top",c.top),n.canvas.pumpRender()}function j(){return u=void 0!==o(u)?o(u):E,D.setRotateState(u),c}function I(t){return function(e,i,o,s){if(!u){e>0&&(e=0),i>0&&(i=0);var a=e+s*n.canvasWidth,r=i+s*n.canvasHeight;a<n.canvasWidth&&(e+=n.canvasWidth-a),r<n.canvasHeight&&(i+=n.canvasHeight-r)}return 1>s?t(e,i,o,s):(c.left=e,c.top=i,c.rotate=o,c.scale=s),c}}function M(t,e,i,o){o=Math.max(l,o),c.left=(1-o)/2*n.canvasWidth,c.top=(1-o)/2*n.canvasHeight,c.rotate=0,c.scale=o}function R(t,e,i,n){c.left=0,c.top=0,c.rotate=0,c.scale=1,l+(1-l)/4>n&&z(a(v(),m()).parent||a(v(),m()))}function F(e){return void 0!==h&&(h(),h=void 0),h=t.layout?t.layout.onLayoutDone(_):window.addEventListener("resize",_),i.utils.domNodeDisposal.addDisposeCallback(e,function(){h(),h=void 0}),h}var D;return F(T,n,b,y),D=t.canvas.touch&&o(d)?t.canvas.touch({canvas:n.canvasElement,renderCallback:O,startCallback:j,stepCallback:I(M),endCallback:I(R)}):{setRotateState:function(){},remove:function(){}},s(d)&&d.subscribe(function(){D.remove(),registerTouchHandler()}),{selectTouch:w,selectZoom:z,selectHeld:N,selectRelease:P}}var h,c={left:0,top:0,rotate:0,scale:1},l=.8;return{setupGestures:n}}}),define("scalejs.visualization-d3/json-helper",["knockout","d3","d3.colorbrewer","scalejs.visualization-d3/nested-data-helper"],function(t,e,i,n){var o=t.utils.unwrapObservable,s=n.getNode,a=e.scale.linear();return function(n,r,h){function c(){p.idPath=o(n.idPath)||"id",p.namePath=o(n.namePath)||p.idPath,p.childrenPath=o(n.childrenPath)||"children",p.areaPath=o(n.areaPath)||"area",p.colorPath=o(n.colorPath)||"color",p.colorPalette=o(n.colorPalette)||"PuBu",p.fontSize=o(n.fontSize)||11,p.fontFamily=o(n.fontFamily)||"Times New Roman",p.fontColor=o(n.fontColor)||"#000",p.colorPalette instanceof Array?1===p.colorPalette.length&&(p.colorPalette[1]=p.colorPalette[0]):p.colorPalette=i[p.colorPalette][3]}function l(t){for(var e,n=[],s=0;s<t.length;s+=1)e=t[s],e instanceof Object?(n[s]={idPath:o(e.idPath)||p.idPath,namePath:o(e.namePath||e.idPath)||p.namePath,childrenPath:o(e.childrenPath)||p.childrenPath,areaPath:o(e.areaPath)||p.areaPath,colorPath:o(e.colorPath)||p.colorPath,fontSize:o(e.fontSize)||p.fontSize,fontFamily:o(e.fontFamily)||p.fontFamily,fontColor:o(e.fontColor)||p.fontColor,colorPalette:o(e.colorPalette)},n[s].colorPalette instanceof Array?1===n[s].colorPalette.length&&(n[s].colorPalette[1]=n[s].colorPalette[0]):n[s].colorPalette=null==n[s].colorPalette?p.colorPalette:i[n[s].colorPalette][3]):n[s]={childrenPath:e||p.childrenPath,idPath:p.idPath,namePath:p.namePath,areaPath:p.areaPath,colorPath:p.colorPath,colorPalette:p.colorPalette,fontSize:p.fontSize,fontFamily:p.fontFamily,fontColor:p.fontColor};return n}function u(t,i,n,o){var s,r,h,c=i[n]||p,l={id:t[c.idPath]||"",name:t[c.namePath]||"",lvl:n,size:void 0!==t[c.areaPath]?t[c.areaPath]:1,colorSize:t[c.colorPath]||0,fontSize:c.fontSize,fontFamily:c.fontFamily,fontColor:c.fontColor};if(!t[c.childrenPath])return o.value<n&&(o.value=n),l;l.children=[],l.childrenReference=[],r=t[c.childrenPath];for(var d=0;d<r.length;d+=1)s=u(r[d],i,n+1,o),s.parent=l,s.index=d,void 0===t[c.areaPath]&&(l.size+=s.size),void 0===t[c.colorPath]&&(l.colorSize+=s.colorSize),l.minSize=Math.min(l.minSize||s.size,s.size),l.maxSize=Math.max(l.maxSize||s.size+1,s.size),l.minColor=Math.min(l.minColor||s.colorSize,s.colorSize),l.maxColor=Math.max(l.maxColor||s.colorSize+1,s.colorSize),l.children[d]=l.childrenReference[d]=s;a.range(i.length<=n+1?p.colorPalette:i[n+1].colorPalette),h=(l.maxColor-l.minColor)/Math.max(a.range().length-1,1),a.domain(e.range(l.minColor,l.maxColor+h,h));for(var d=0;d<r.length;d+=1)l.children[d].color=a(l.children[d].colorSize);return l}var d,p={},f={unordered:function(t,e){return t.index-e.index},ascendingSize:function(t,e){return t.size-e.size},descendingSize:function(t,e){return e.size-t.size}};return d=t.computed(function(){var t,i,r={value:0},d=o(n.sortBy)||"unordered",p=o(n.maxVisibleLevels),g=o(n.data)||{name:"Empty"},v=o(n.levels)||[{}];return c(),i=l(v),root=u(g,i,0,r,0),p=p||r.value+1,root.sortBy=d instanceof Function?d:f[d]?f[d]:d.unordered,a.range(i[0].colorPalette),t=2/Math.max(a.range().length-1,1),a.domain(e.range(root.colorSize-t/2,root.colorSize+t/2,t)),root.color=a(root.colorSize),root.curLevel=s(h(),root).lvl,root.curMaxLevel=root.curLevel+p-1,root.maxlvl=r.value,root.maxVisibleLevels=p,root.levels=i,root.index=0,root})}}),define("scalejs.visualization-d3/color-helper",[],function(){function t(t){var e,i=1;return 0===t.indexOf("rgba")&&(e=t.substring(5,t.length-1).replace(/ /g,"").split(","),i=Number(e.pop()),t="rgb("+e.join(",")+")"),{color:t,opacity:i}}return{parseColor:t}}),define("scalejs.visualization-d3/visualizations/treemap",["d3","scalejs.visualization-d3/canvas-helper","scalejs.visualization-d3/gesture-helper","knockout","scalejs.visualization-d3/json-helper","scalejs.visualization-d3/nested-data-helper","scalejs.visualization-d3/color-helper"],function(t,e,i,n,o,s,a){function r(){function t(t){return(t-e[0])/n*o+i[0]}var e=[0,1],i=[0,1],n=1,o=1;return t.domain=function(i){return arguments.length?(e=i,n=e[1]-e[0],t):e},t.range=function(e){return arguments.length?(i=e,o=i[1]-i[0],t):i},t}function h(){function n(t,e){if(!t.parent)return{x:t.x,y:t.y,dx:t.dx,dy:t.dy};var i=H/I,o=H/M,s=n(t.parent);return e?{x:s.dx/t.parent.dx*(t.x-t.parent.x)+s.x+i/2,y:s.dy/t.parent.dy*(t.y-t.parent.y)+s.y+o/2,dx:s.dx/t.parent.dx*t.dx-i,dy:s.dy/t.parent.dy*t.dy-o}:{x:s.dx/t.parent.dx*(t.x-t.parent.x)+s.x+i,y:s.dy/t.parent.dy*(t.y-t.parent.y)+s.y+o,dx:s.dx/t.parent.dx*t.dx-2*i,dy:s.dy/t.parent.dy*t.dy-2*o}}function s(e){return function(i){var o,s,a,r,h=n(i,i),c=i.children&&i.lvl<root.curMaxLevel?j(i.lvl/(root.maxlvl-1)):i.color,l=g(c),u=t.interpolate(this.backFill,l.color),d=t.interpolate(this.opacity,e*l.opacity),p=this;return i.sx=N(h.x),i.sy=S(h.y),i.sdx=Math.max(I*h.dx,0),i.sdy=Math.max(M*h.dy,0),o=t.interpolate(this.left,i.sx),s=t.interpolate(this.top,i.sy),a=t.interpolate(this.width,i.sdx),r=t.interpolate(this.height,i.sdy),c!==this.backFill?function(t){p.left=o(t),p.top=s(t),p.width=a(t),p.height=r(t),p.backFill=u(t),p.opacity=d(t)}:function(t){p.left=o(t),p.top=s(t),p.width=a(t),p.height=r(t),p.opacity=d(t)}}}function a(){return function(e){var i,n=t.interpolate(this.left,e.sdx/2),o=t.interpolate(this.top,e.sdy/2),s=g(e.fontColor),a=t.interpolate(this.fill,s.color),r=this;return i=W?t.interpolate(this.opacity,e.children&&e.lvl<root.curMaxLevel?0:s.opacity):t.interpolate(this.opacity,!(e.children&&e.lvl<root.curMaxLevel)&&e.sdx-1>=this.width&&e.sdy-1>=this.height?s.opacity:0),this.fontFamily=e.fontFamily,this.fontSize=e.fontSize,function(t){r.left=n(t),r.top=o(t),r.opacity=i(t),r.fill=a(t)}}}function h(t,e,i,n){t.filter(function(t){return!(t.children&&t.lvl<root.curMaxLevel)}).on("touch",b).on("hold",P).on("release",w).on("tap",function(t){_(t.parent||t)}),t.transition().duration(n).tween("groupTween",s(1)),e.transition().duration(n).tween("textTween",a(i))}function c(e){var i,o,s,r,c,l,u=T(),v=d(A(),T());e=void 0!==e?e:1e3,i=z.size([E.canvasWidth,E.canvasHeight]).sort(u.sortBy).nodes(u).filter(function(t){return p(t,f(v))<u.maxVisibleLevels}).sort(function(t,e){return t.depth===e.depth?e.value-t.value:t.depth-e.depth}),o=O.selectAll("group").data(i,function(t){return t.id}),s=o.enter().append("group").each(function(t){var e=t.parent||t,i=g(t.children&&t.lvl<u.curMaxLevel?j(t.lvl/(u.maxlvl-1)):t.color);this.left=N(e.x)+I*e.dx/2,this.top=S(e.y)+M*e.dy/2,this.backFill=i.color,this.opacity=0}),c=s.append("text").each(function(t){this.originX="center",this.originY="center",this.left=0,this.top=0,this.fontFamily=t.fontFamily,this.fontSize=t.fontSize;var e=g(t.fontColor);this.fill=e.color,this.setText(t.name),this.opacity=W?t.parent&&t.parent.children&&t.parent.lvl<u.curMaxLevel?e.opacity:0:t.parent&&t.parent.children&&t.parent.lvl<u.curMaxLevel&&I*t.dx-2*H>=this.width&&M*t.dy-2*H>=this.height?e.opacity:0}),I=E.canvasWidth/v.dx,M=E.canvasHeight/v.dy,N.domain([v.x,v.x+v.dx]),S.domain([v.y,v.y+v.dy]),h(s,c,v,e),h(o,o.select("text"),v,e),o.filter(function(t){return t.children&&t.lvl<u.curMaxLevel}).on("touch",null).on("tap",null).on("hold",null),r=o.exit().transition().duration(e).tween("groupTween",function(e){var i=n(e.parent||e,e.parent||e),o=t.interpolate(this.left,N(i.x+i.dx/2)),s=t.interpolate(this.top,S(i.y+i.dy/2)),a=t.interpolate(this.width,0),r=t.interpolate(this.height,0),h=t.interpolate(this.opacity,0),c=this;return function(t){c.left=o(t),c.top=s(t),c.width=a(t),c.height=r(t),c.opacity=h(t)}}).each(function(){this.remove()},"end"),l=r.select("text").each(function(t){t.sdx=0,t.sdy=0}).tween("textTween",a(v)),t.event&&t.event.stopPropagation()}function v(t,e){E.canvasWidth=t,E.canvasHeight=e,E.canvas.attr("width",E.canvasWidth),E.canvas.attr("height",E.canvasHeight),N.range([0,E.canvasWidth]),S.range([0,E.canvasHeight])}function m(t){E=e.initializeCanvas(t)}function x(t){var e=gestureHelper.setupGestures(E,X,C,D,V,Y,A,T,U,v,L,t,c);b=e.selectTouch,_=e.selectZoom,P=e.selectHeld,w=e.selectRelease}function y(e,n){var s,a;gestureHelper=i(),R=n(),F=void 0===R.triggerTime?10:R.triggerTime,X=R.enableRotate,D=R.enableZoom||!1,C=R.enableTouch||!1,W=R.allowTextOverflow||!1,A=u(R.zoomedItemPath)?R.zoomedItemPath:l(R.zoomedItemPath),void 0===A()&&A([]),Y=u(R.selectedItemPath)?R.selectedItemPath:l(R.selectedItemPath),void 0===Y()&&Y([]),V=u(R.heldItemPath)?R.heldItemPath:l(R.heldItemPath),void 0===V()&&V([]),A.subscribe(function(t){var e=d(t,T());e||(A([]),e=T()),e&&(T().curLevel=e.lvl,T().curMaxLevel=e.lvl+T().maxVisibleLevels-1,c())}),Y.subscribe(function(t){d(t,T())||Y(void 0)}),T=o(R,F,A),a=T(),T.subscribe(function(){c()}),m(e),x(e),N=r().range([0,E.canvasWidth]),S=r().range([0,E.canvasHeight]),j=void 0===R.borderColor?t.interpolate("#888","#fff"):t.interpolate(R.borderColor[0],R.borderColor[1]),z=t.layout.treemap().round(!1).sort(a.sortBy).size([E.canvasWidth,E.canvasHeight]).sticky(!1).mode("squarify").value(function(t){return t.size}).children(function(t){return t.children}),O=E.canvas.append("group").each(function(){this.fontFamily="Times New Roman",this.fontSize=11}),s=z.nodes(a).filter(function(t){return p(t,f(d(A(),T())))<a.maxVisibleLevels}).sort(function(t,e){return t.depth===e.depth?e.value-t.value:t.depth-e.depth}),O.selectAll("group").data(s,function(t){return t.id}),k=d(A(),T()),I=E.canvasWidth/k.dx,M=E.canvasHeight/k.dy,N.domain([k.x,k.x+k.dx]),S.domain([k.y,k.y+k.dy]),c(0)}var E,T,b,_,P,w,N,S,z,O,j,I,M,R,F,D,C,A,Y,V,k,H=3,X=!1,L=!1,U=!0,W=!1;return{initializeTreemap:y}}function c(t,e){var i=h();i.initializeTreemap(t,e)}var l=n.observable,u=n.isObservable,d=s.getNode,p=s.getDistanceToTreePath,f=s.getNodeTreePath,g=a.parseColor;return{init:c}}),define("scalejs.visualization-d3/visualizations/sunburst",["knockout","d3","scalejs.visualization-d3/canvas-helper","scalejs.visualization-d3/gesture-helper","scalejs.visualization-d3/json-helper","scalejs.visualization-d3/nested-data-helper","scalejs.visualization-d3/color-helper"],function(t,e,i,n,o,s,a){function r(){function t(t){return Math.max(0,Math.min(2*Math.PI,F(t.x)))}function s(t){return Math.max(0,Math.min(2*Math.PI,F(t.x+t.dx)))}function a(t){return Math.max(0,D(t.y))}function r(t){return Math.max(0,D(t.y+t.dy))}function h(t,e){var i,n=[];for(i=0;t>i;i+=1)n[i]=e;return n}function v(t,e){var i=0,n=t.levelsFr,o=t.fr||1,s=t.parentFr||1;return n.length<C.maxlvl+1&&(n=n.concat(h(C.maxlvl-n.length+1,o))),n=n.map(function(t,n){return n===e.lvl-1?i+=s:n>e.lvl-1&&n<=C.curMaxLevel?i+=t:i}).map(function(t,e,i){return t/i[i.length-1]*R}),n.unshift(0),n}function m(t){var e,i=[];for(e=0;e<t.length;e+=1)i.push(e/(t.length-1));return i}function x(t){var i=k&&k.levelsFr,n=i?v(k,t):[t.y?t.dy*R/2:0,R],o=i?m(n,t):[t.y,(C.curMaxLevel+1)/(C.maxlvl+1)];return function(){var i=e.interpolate(F.domain(),[t.x,t.x+t.dx]),s=e.interpolate(D.domain(),o),a=e.interpolate(D.range(),n);return function(t){F.domain(i(t)),D.domain(s(t)).range(a(t))}}}function y(t){return function(i){var n=e.interpolate(this.old.x,i.x),o=e.interpolate(this.old.y,i.y),s=e.interpolate(this.old.dx,i.dx),a=e.interpolate(this.old.dy,i.dy),r=e.interpolate(this.left,S.canvasWidth/2),h=e.interpolate(this.top,S.canvasHeight/2),c=g(i.color),l=e.interpolate(this.opacity,t*c.opacity);return function(t){this.old.x=n(t),this.old.y=o(t),this.old.dx=s(t),this.old.dy=a(t),this.left=r(t),this.top=h(t),this.opacity=l(t)}}}function E(){return function(i){var n=g(i.color),o=e.interpolate(this.fill,n.color),h=e.interpolate(this.opacity,n.opacity);return function(e){this.fill=o(e),this.opacity=h(e),this.innerRadius=a(this.old),this.outerRadius=r(this.old),this.startAngle=t(this.old),this.endAngle=s(this.old)}}}function T(i){return function(n){var o,h,c,l,u,d,p,f,v,m=g(n.fontColor),x=e.interpolate(this.fill,m.color),y=e.interpolate(this.opacity,m.opacity);return this.fontFamily=n.fontFamily,this.fontSize=n.fontSize,function(e){u=r(this.old),d=a(this.old),p=t(this.old),f=s(this.old),v=(f-p)*d,this.fill=x(e),o=F(this.old.x+this.old.dx/2),h=o-Math.PI/2,c=D(n.y)+2,l=180*o/Math.PI-90,this.left=c*Math.cos(h),this.top=c*Math.sin(h),i!==n?(l>90&&(l=(l+180)%360),this.originX=o>Math.PI?"right":"left",this.opacity=Q?y(e):u-d-4>=this.width&&(v-2>=this.height||i===n&&1>d)?y(e):0):(l-=90,this.originX="center",this.originY="top",this.opacity=Q?y(e):u-d-4>=this.height&&(v-2>=this.width||i===n&&1>d)?y(e):0),this.angle=k&&null!=k.enableRotatedText?k.enableRotatedText?l:0:l}}}function b(i){var n,o,r,h,l,u,v,m,b,_,P=d(W(),z());i=void 0!==i?i:1e3,C=z(),k=c(H),n=A.sort(C.sortBy).nodes(C).filter(function(t){return p(t,f(P))<C.maxVisibleLevels}),o=V.selectAll("group").data(n,function(t){return t.id}),r=o.enter().append("group").each(function(t){this.left=S.canvasWidth/2,this.top=S.canvasHeight/2,this.opacity=0,this.old={x:t.x,y:t.y,dx:t.dx,dy:t.dy}}),u=r.append("arc").each(function(e){this.fill=e.color,this.outerRadius=this.innerRadius=a(e),this.endAngle=this.startAngle=(s(e)-t(e))/2,this.old=this.parent.old}).on("touch",O).on("tap",j).on("hold",I).on("release",M),b=r.append("text").each(function(t){C!==t?(this.originX=F(t.x+t.dx/2)>Math.PI?"right":"left",this.originY="center"):(this.originX="center",this.originY="top"),this.fontFamily=t.fontFamily,this.fontSize=t.fontSize;var e=g(t.fontColor),i=180*F(t.x+t.dx/2)/Math.PI-90;this.fill=e.color,this.setText(t.name),t.bw=D(t.y+t.dy)-D(t.y),t.bh=(F(t.x+t.dx)-F(t.x))*D(t.y),C!==t?(i>90&&(i=(i+180)%360),this.opacity=Q?e.opacity:t.bw-4>=this.height&&(t.bh-2>=this.width||C===t&&D(t.y)<1)?e.opacity:0):(i-=90,this.opacity=Q?e.opacity:t.bw-4>=this.width&&(t.bh-2>=this.height||C===t&&D(t.y)<1)?e.opacity:0),this.angle=i,this.left=(Math.max(D(t.y),0)+2)*Math.cos(F(t.x+t.dx/2)-Math.PI/2),this.top=(Math.max(D(t.y),0)+2)*Math.sin(F(t.x+t.dx/2)-Math.PI/2),this.old=this.parent.old}),V.transition().duration(i).tween("zoomTween",x(P)),r.transition().duration(i).tween("groupTween",y(1)),u.transition().duration(i).tween("arcTween",E(P)),b.transition().duration(i).tween("textTween",T(P)),o.transition().duration(i).tween("groupTween",y(1)),l=o.select("arc").transition().duration(i).tween("arcTween",E(P)),m=o.select("text").transition().duration(i).tween("textTween",T(P)),h=o.exit().transition().duration(i).tween("groupTween",y(0)).each(function(){this.remove()},"end"),v=h.select("arc").tween("arcTween",E(P)),_=h.select("text").tween("textTween",T(P)),e.event&&e.event.stopPropagation()}function _(t,e){S.canvasWidth=t,S.canvasHeight=e,S.canvas.attr("width",S.canvasWidth),S.canvas.attr("height",S.canvasHeight),R=Math.min(S.canvasWidth,S.canvasHeight)/2}function P(t){S=i.initializeCanvas(t)}function w(t){var e=gestureHelper.setupGestures(S,Z,U,L,q,B,W,z,J,_,K,t,b);O=e.selectTouch,j=e.selectZoom,I=e.selectHeld,M=e.selectRelease}function N(t,i){var s,a;gestureHelper=n(),H=i(),X=void 0===H.triggerTime?10:H.triggerTime,Z=H.enableRotate,L=H.enableZoom||!1,U=H.enableTouch||!1,Q=H.allowTextOverflow||!1,W=u(H.zoomedItemPath)?H.zoomedItemPath:l(H.zoomedItemPath),void 0===W()&&W([]),B=u(H.selectedItemPath)?H.selectedItemPath:l(H.selectedItemPath),void 0===B()&&B([]),q=u(H.heldItemPath)?H.heldItemPath:l(H.heldItemPath),void 0===q()&&q([]),W.subscribe(function(t){var e=d(t,z());e||(W([]),e=z()),e&&(z().curLevel=e.lvl,z().curMaxLevel=e.lvl+z().maxVisibleLevels-1,b())}),B.subscribe(function(t){d(t,z())||B(void 0)}),z=o(H,X,W),a=z(),z.subscribe(function(){b()}),P(t),w(t),R=Math.min(S.canvasWidth,S.canvasHeight)/2,F=e.scale.linear().range([0,2*Math.PI]),D=e.scale.linear().range([0,R]),A=e.layout.partition().sort(a.sortBy).value(function(t){return t.size}).children(function(t){return t.children}),Y=S.canvas.append("group"),V=Y.append("group").each(function(){this.fontFamily="Times New Roman",this.fontSize=11}),s=A.nodes(a).filter(function(t){return p(t,f(d(W(),z())))<a.maxVisibleLevels}),V.selectAll("group").data(s,function(t){return t.id}),G=d(W(),z()),F.domain([G.x,G.x+G.dx]),D.domain([G.y,(a.curMaxLevel+1)/(a.maxlvl+1)]).range([G.y?G.dy*R/2:0,R]),b(0)}var S,z,O,j,I,M,R,F,D,C,A,Y,V,k,H,X,L,U,W,B,q,G,Z=!0,K=!0,J=!1,Q=!1;return{initializeSunburst:N}}function h(t,e){var i=r();i.initializeSunburst(t,e)}var c=t.utils.unwrapObservable,l=t.observable,u=t.isObservable,d=s.getNode,p=s.getDistanceToTreePath,f=s.getNodeTreePath,g=a.parseColor;return{init:h}}),define("scalejs.visualization-d3/loader",["scalejs!core","knockout"],function(t,e){e.unwrap;e.bindingHandlers.visualizations&&console.error("visualizations is already setup"),e.virtualElements.allowedBindings.visualizations=!0,e.bindingHandlers.visualizations={init:function(t,e){function i(){var i=require("./scalejs.visualization-d3/visualizations/"+n());void 0!==i?i.init(t,e):console.warn("Invalid visualization type:",n())}var n=e().type;n.subscribe(i),i()}}}),define("scalejs.visualization-d3",["knockout","scalejs.visualization-d3/visualizations/treemap","scalejs.visualization-d3/visualizations/sunburst","scalejs.visualization-d3/loader"],function(t,e,i){t.bindingHandlers.treemap&&console.error("treemap is already setup"),t.bindingHandlers.sunburst&&console.error("sunburst is already setup"),t.bindingHandlers.treemap=e,t.bindingHandlers.sunburst=i,t.virtualElements.allowedBindings.treemap=!0,t.virtualElements.allowedBindings.sunburst=!0});